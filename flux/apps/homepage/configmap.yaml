---
apiVersion: v1
kind: ConfigMap
metadata:
  name: homepage
  namespace: homepage
data:
  settings.yaml: |
    title: Homelab
    background:
      image: https://images.unsplash.com/photo-1526992356629-fbf40452d54d?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=1773
      blur: sm # sm, "", md, xl... see https://tailwindcss.com/docs/backdrop-blur
    favicon: "https://raw.githubusercontent.com/pxldi/homelab/refs/heads/main/flux/apps/homepage/resources/house-icon.png"
    theme: dark
    color: cyan

    useEqualHeights: true
    cardBlur: xl
    headerBlur: xl

    debug: true

    headerStyle: boxed
    hideVersion: true

    statusStyle: "dot"

    layout:
      #Media:
      #  style: columns
      #  columns: 5
      System:
        style: columns
  kubernetes.yaml: |
    mode: cluster
  widgets.yaml: |
    - prometheus:
        href: http://kube-prometheus-stack-prometheus.monitoring.svc.cluster.local:9090
        fields:
          - label: CPU Usage
            query: 100 - (avg(rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)
            format: percent
          
          - label: RAM Usage
            query: 100 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes * 100)
            format: percent
          
          - label: RAM Free
            query: node_memory_MemAvailable_bytes / 1024 / 1024 / 1024
            format: number
            suffix: " GB"
          
          - label: NVMe (/var)
            query: 100 - (node_filesystem_avail_bytes{mountpoint="/var"} / node_filesystem_size_bytes{mountpoint="/var"} * 100)
            format: percent
          
          - label: HDD1
            query: 100 - (node_filesystem_avail_bytes{mountpoint="/var/mnt/hdd1"} / node_filesystem_size_bytes{mountpoint="/var/mnt/hdd1"} * 100)
            format: percent
          
          - label: HDD2
            query: 100 - (node_filesystem_avail_bytes{mountpoint="/var/mnt/hdd2"} / node_filesystem_size_bytes{mountpoint="/var/mnt/hdd2"} * 100)
            format: percent
    - kubernetes:
        cluster:
          show: true
          cpu: true
          memory: true
          showLabel: true
        nodes:
          show: true
          cpu: true
          memory: true
          showLabel: true
    
    - search:
        provider: duckduckgo
        target: _blank
    
    - datetime:
        text_size: xl
        format:
          timeStyle: short
  services.yaml: |
    - System:
      - Traefik:
          icon: traefik.png 
          href: https://traefik.pxldi.de
          description: Traefik Dashboard
          app: traefik
          namespace: traefik
  bookmarks.yaml: ""
  docker.yaml: ""
  custom.css: ""
  custom.js: ""